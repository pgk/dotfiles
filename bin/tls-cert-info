#!/usr/bin/env bash
set -euo pipefail

command -v openssl >/dev/null 2>&1 || {
  echo "you need to install openssl" >&2
  exit 1
}

DOMAIN="${1:-}"
PORT="${2:-443}"

[[ -n "$DOMAIN" ]] || {
  echo "usage: $0 <domain> [port]" >&2
  exit 2
}

openssl s_client -servername "$DOMAIN" -connect "$DOMAIN:$PORT" </dev/null 2>/dev/null |
  openssl x509 -noout -dates -issuer -subject
